<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> AngularJS recompile after ng-bind-html · Zhipeng Jiang</title><meta name="description" content="AngularJS recompile after ng-bind-html - Zhipeng Jiang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/jesusjzp" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/zp-j" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">AngularJS recompile after ng-bind-html</h1><div class="post-time">Jul 30, 2014</div><div class="post-content"><p>Just as indicated here in StackOverflow, <a href="http://stackoverflow.com/questions/17417607/angular-ng-bind-html-unsafe-and-directive-within-it" target="_blank" rel="external">angular ng-bind-html-unsafe and directive within it</a>:</p>
<pre><code>I have a element which I would like to bind html to it.

&amp;lt;div ng-bind-html-unsafe=&quot;details&quot; upper&amp;gt;&amp;lt;/div&amp;gt;

That works. Now, along with it I also have a directive which is bound to the bound html:

$scope.details = &apos;Success! &amp;lt;a href=&quot;#/details/12&quot; upper&amp;gt;details&amp;lt;/a&amp;gt;&apos;

But the directive upper with the div and anchor do not evaluate. How do I make it work?
`&lt;/pre&gt;

Someone responds responds below with a runable example:

&lt;pre&gt;`I was also facing this problem and after hours searching the internet I read @Chandermani&apos;s comment, which proved to be the solution. You need to call a &apos;compile&apos; directive with this pattern:

HTML:

&amp;lt;div compile=&quot;details&quot;&amp;gt;&amp;lt;/div&amp;gt;

JS:

angular.module(&apos;yourAppName&apos;)
  .directive(&apos;compile&apos;, [&apos;$compile&apos;, function ($compile) {
  return function(scope, element, attrs) {
      scope.$watch(
        function(scope) {
           // watch the &apos;compile&apos; expression for changes
          return scope.$eval(attrs.compile);
        },
        function(value) {
          // when the &apos;compile&apos; expression changes
          // assign it into the current DOM
          element.html(value);

          // compile the new DOM and link it to the current
          // scope.
          // NOTE: we only compile .childNodes so that
          // we don&apos;t get into infinite loop compiling ourselves
          $compile(element.contents())(scope);
        }
    );
};
}]);

You can see a [working fiddle of it here](http://jsfiddle.net/NWZZE/6/)
`&lt;/pre&gt;

Ok, well, this piece of code dose work, this example is simple enough to understand how to recompile binding templates. Actually, if the hierarchy is far more complex, this `scope` might results in error. Please note that in the example above, there’s only one scope.

So thanks for Florian, he gives me a solution, that is to pass the root scope as attributes of directive, so this code may look like this:

&lt;pre&gt;`HTML:

&amp;lt;div ng-bind-html=&quot;details&quot; do-compile=&quot;scope&quot;&amp;gt;&amp;lt;/div&amp;gt;

JS:

angular.module(&apos;yourAppName&apos;)
  .directive(&apos;doCompile&apos;, [&apos;$compile&apos;, function ($compile) {
  return function(scope, element, attrs) {
  var selectedScope = attrs.doCompile &amp;amp;&amp;amp; scope.$eval(attrs.doCompile);
  if (!element.hasClass(&apos;compiled&apos;)) {
    element.addClass(&apos;compiled&apos;);
    compile(element.contents())(selectedScope || scope);
  }
    };
}]);
</code></pre></div></article></div></section><footer><div class="paginator"><a href="/2014/07/31/胡言乱语3/" class="prev">PRVE</a><a href="/2014/07/15/AngularJS-Cache-cacheFactory/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ZhipengJiang';
var disqus_identifier = '2014/07/30/AngularJS-recompile-after-ng-bind-html/';
var disqus_title = 'AngularJS recompile after ng-bind-html';
var disqus_url = 'http://yoursite.com/2014/07/30/AngularJS-recompile-after-ng-bind-html/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ZhipengJiang.disqus.com/count.js" async></script><div class="copyright"><p>© 2013 - 2016 <a href="http://yoursite.com">Zhipeng Jiang</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-47515905-1",'auto');ga('send','pageview');</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>