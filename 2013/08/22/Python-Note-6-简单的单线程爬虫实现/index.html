<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Python Note (6) - 简单的单线程爬虫实现 · Zhipeng Jiang</title><meta name="description" content="Python Note (6) - 简单的单线程爬虫实现 - Zhipeng Jiang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/jesusjzp" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/zp-j" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Python Note (6) - 简单的单线程爬虫实现</h1><div class="post-time">Aug 22, 2013</div><div class="post-content"><h1 id="单线程爬虫的实现"><a href="#单线程爬虫的实现" class="headerlink" title="单线程爬虫的实现"></a>单线程爬虫的实现</h1><hr>
<p>终于要开始动手写python代码了。就从实际出发吧，写一个简单的单线程爬虫。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>先上代码吧，各位大牛看了代码就知道这个示例有多么简单了。</p>
<pre class="prettyprint linenums">
#!/usr/bin/python
# Filename: httpGet.py

import urllib2
from bs4 import BeautifulSoup
import re
siteUrls = " "

url = "http://zp-j.github.io/"
def getContent(url):
    content = urllib2.urlopen(url).read()
    #print content

    soup=BeautifulSoup(content)
    global siteUrls
    siteUrls = soup.findAll('a',attrs={'class':'post'})
    #nextUrl = soup.find('div',attrs={'class':'topicListFooter'})
    #print siteUrls
    #print str(nextUrl)
    strip_tag_pat=re.compile('&lt;/?\w+[^&gt;]*&gt;')

    f = file('info.txt','w')
    for i in siteUrls:
        i0 = re.sub(strip_tag_pat,' ',str(i))
        i1 = str(i).split(' ')
        #print i1
        html = i1[2][6:-1]
        #print html + i0
        f.write(html+i0+'\n')
    f.close()

getContent(url)
</pre>

<h2 id="代码说明"><a href="#代码说明" class="headerlink" title="代码说明"></a>代码说明</h2><p>总的来说，这里稍微高级一点点的就是用到了BeautifulSoup这个模块，这样做数据提取方便了很多。</p>
<h3 id="BeautifulSoup安装"><a href="#BeautifulSoup安装" class="headerlink" title="BeautifulSoup安装"></a>BeautifulSoup安装</h3><p>因为我使用的是fedora19，不能保证下面的方法在所有的pc上都适用。</p>
<pre><code>sudo yum install pip
sudo pip install beautifulsoup4
`&lt;/pre&gt;

需要注意的是，安装完成之后，代码里不能直接使用import，不然会报错找不到module。应该写成`from bs4 import BeautifulSoup`。

### 具体使用

我们先看一下需要提取的数据所在的html源码，

&lt;pre&gt;`&amp;lt;ul&amp;gt;
    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 22, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/22/python-module&quot; class=&quot;post&quot;&amp;gt;Python Note (6) - 简单的单线程爬虫实现&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 21, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/21/symfony2-test&quot; class=&quot;post&quot;&amp;gt;Symfony2 (4) - atoum进行单元测试&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 20, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/20/za&quot; class=&quot;post&quot;&amp;gt;发一点怨念&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 19, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/19/symfony2-test&quot; class=&quot;post&quot;&amp;gt;Symfony2 (3) - atoum进行单元测试&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 17, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/17/symfony2-generate-doc&quot; class=&quot;post&quot;&amp;gt;Symfony2 (2) - NelmioApiDocBundle自动生成文档(译)&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 17, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/17/symfony2-create-bundle&quot; class=&quot;post&quot;&amp;gt;Symfony2 (1) - 新建一个bundle&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 17, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/17/jekyll-bootstrap-code-highlighting&quot; class=&quot;post&quot;&amp;gt;Jekyll-bootstrap添加代码高亮&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 16, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/16/symfony2-install&quot; class=&quot;post&quot;&amp;gt;Symfony2 (0) - installation and configuration&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 15, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/15/python-data-structure&quot; class=&quot;post&quot;&amp;gt;Python Note (5) - data structure&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;

    &amp;lt;li&amp;gt;&amp;lt;span&amp;gt;August 14, 2013&amp;lt;/span&amp;gt;  : &amp;lt;a href=&quot;/blog/2013/08/14/python-template&quot; class=&quot;post&quot;&amp;gt;Python Note (4) - template&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
</code></pre><p>代码结构还是很清楚的。</p>
<p>在执行完获取html源码的操作后，<code>siteUrls = soup.findAll(&#39;a&#39;,attrs={&#39;class&#39;:&#39;post&#39;})</code>把所有<code>a</code>标签中<code>class</code>为<code>post</code>的数据抽取出来放到siteUrls这个数组中。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2013/08/22/Python-Note-7/" class="prev">PRVE</a><a href="/2013/08/21/Symfony2-4-atoum进行单元测试/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ZhipengJiang';
var disqus_identifier = '2013/08/22/Python-Note-6-简单的单线程爬虫实现/';
var disqus_title = 'Python Note (6) - 简单的单线程爬虫实现';
var disqus_url = 'http://yoursite.com/2013/08/22/Python-Note-6-简单的单线程爬虫实现/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ZhipengJiang.disqus.com/count.js" async></script><div class="copyright"><p>© 2013 - 2016 <a href="http://yoursite.com">Zhipeng Jiang</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-47515905-1",'auto');ga('send','pageview');</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>