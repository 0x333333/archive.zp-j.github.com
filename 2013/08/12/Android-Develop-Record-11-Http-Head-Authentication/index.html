<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Android Develop Record(11) - Http Head Authentication · Zhipeng Jiang</title><meta name="description" content="Android Develop Record(11) - Http Head Authentication - Zhipeng Jiang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/jesusjzp" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/zp-j" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Android Develop Record(11) - Http Head Authentication</h1><div class="post-time">Aug 12, 2013</div><div class="post-content"><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>Accidentally, for the time being there is no “api-users” for the android application,so we check user account by checking http request header. Like this:</p>
<pre><code>2011-02-23 15:37:36: (request.c.304) fd: 8 request-len: 308
POST /test.php HTTP/1.1
Accept: application/json
User-Agent: Apache-HttpClient/4.1 (java 1.5)
Host: myhost.com
Authorization: Basic YnxpcYRlc3RwMTulHGhlSGs=
Content-Length: 21
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Content-Encoding: UTF-8
Connection: Keep-Alive

HTTP/1.1 200 OK
Content-type: text/html
Transfer-Encoding: chunked
</code></pre><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><pre class="prettyprint linenums">
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;

import org.apache.http.HttpResponse;
import org.apache.http.auth.UsernamePasswordCredentials;
import org.apache.http.client.CookieStore;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.auth.BasicScheme;
import org.apache.http.impl.client.AbstractHttpClient;
import org.apache.http.impl.client.DefaultHttpClient;

import android.util.Log;

public class HttpGetMethod {

        public String getFoldersStats(String username, String password, String action) {
            String res = "";
            try {
                String url = URL ADDRESS+action;
                HttpGet httpReq = new HttpGet(url);

                // add header information
                httpReq.addHeader(BasicScheme.authenticate(
                        new UsernamePasswordCredentials(username, password),
                        "UTF-8", false));
                DefaultHttpClient httpClient = new DefaultHttpClient();
                HttpResponse httpResponse = httpClient.execute(httpReq);

                // handler responds
                StringBuilder builder = new StringBuilder();
                BufferedReader reader = new BufferedReader(new InputStreamReader(
                        httpResponse.getEntity().getContent()));
                for (String s = reader.readLine(); s != null; s = reader.readLine()) {
                    builder.append(s);
                }
                res = builder.toString();

                // Save to cookie
                CookieStore cookieStore = ((AbstractHttpClient) httpClient).getCookieStore();
            } catch (Exception e) {
                Log.e("", e.toString());
            }
            return res;
        }
}
</pre>

<hr>
<h1 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h1><p>因为经常忘记怎么用java代码取资源文件，这里记录一下吧，省得以后在网上乱找。</p>
<p>比方说，某个textview的控件tv_username，想设置为某个string.xml文件里的值</p>
<pre class="prettyprint linenums">
tv_username.setText(context.getResources().getString(R.string.username);
</pre>

<p>-EOF-</p>
</div></article></div></section><footer><div class="paginator"><a href="/2013/08/13/Python-Note-2/" class="prev">PRVE</a><a href="/2013/08/11/Python-Tutorial-1/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'ZhipengJiang';
var disqus_identifier = '2013/08/12/Android-Develop-Record-11-Http-Head-Authentication/';
var disqus_title = 'Android Develop Record(11) - Http Head Authentication';
var disqus_url = 'http://yoursite.com/2013/08/12/Android-Develop-Record-11-Http-Head-Authentication/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//ZhipengJiang.disqus.com/count.js" async></script><div class="copyright"><p>© 2013 - 2016 <a href="http://yoursite.com">Zhipeng Jiang</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-47515905-1",'auto');ga('send','pageview');</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>